<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raspberry Pi Status Monitor</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Raspberry Pi Status Monitor</h1>
            <h2>‚è±Ô∏è Uptime: {{ system_info.uptime }}</h2>
            <p>Real-time system monitoring with historical data</p>
        </header>
        
        <div class="dashboard">
            <div class="card">
                <div class="card-header cpu">
                    <span>üñ•Ô∏è CPU</span>
                </div>
                <div class="stat-row">
                    <div class="stat-value" id="cpu-usage">{{ system_info.cpu.usage }}%</div>
                    <div class="stat-value" id="cpu-frequency">{{ system_info.cpu.frequency }}</div>
                </div>
                <div class="progress-container">
                    <div class="progress-label">
                        <span>Usage</span>
                        <span id="cpu-percentage">{{ system_info.cpu.usage }}%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill cpu" id="cpu-progress" style="width: {{ system_info.cpu.usage }}%"></div>
                    </div>
                </div>
                <div class="chart-container small-charts">
                    <canvas id="cpu-chart"></canvas>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header memory">
                    <span>üíæ Memory</span>
                </div>
                <div class="stat-value" id="memory-usage">{{ system_info.memory.used }} GB / {{ system_info.memory.total }} GB</div>
                <div class="progress-container">
                    <div class="progress-label">
                        <span>Usage</span>
                        <span id="memory-percentage">{{ system_info.memory.percentage }}%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill memory" id="memory-progress" style="width: {{ system_info.memory.percentage }}%"></div>
                    </div>
                </div>
                <div class="chart-container small-charts">
                    <canvas id="memory-chart"></canvas>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header disk">
                    <span>üíø Disk</span>
                </div>
                <div class="stat-value" id="disk-usage">{{ system_info.disk.used }} GB / {{ system_info.disk.total }} GB</div>
                <div class="progress-container">
                    <div class="progress-label">
                        <span>Usage</span>
                        <span id="disk-percentage">{{ system_info.disk.percentage }}%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill disk" id="disk-progress" style="width: {{ system_info.disk.percentage }}%"></div>
                    </div>
                </div>
                <div class="chart-container small-charts">
                    <canvas id="disk-chart"></canvas>
                </div>
            </div>

            <div class="card">
                <div class="card-header temp">
                    <span>üå°Ô∏è Temperature</span>
                </div>
                <div class="stat-value" id="temperature">{{ system_info.temperature }}¬∞C</div>
                <div class="chart-container">
                    <canvas id="temp-chart"></canvas>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header network">
                    <span>üåê Network</span>
                </div>
                <div class="interface-list" id="interface-list">
                    <!-- Network interfaces will be populated by JavaScript -->
                    {% for iface, stats in system_info.network.interfaces.items() %}
                    <div class="interface-card">
                        <h3>{{ iface }}</h3>
                        {% if stats.speed %}
                        <div class="interface-speed">{{ stats.speed }} Mbps</div>
                        {% endif %}
                        <div class="network-stats">
                            <div class="network-stat">
                                <div>Sent</div>
                                <div class="network-stat-value" id="bytes-sent-{{ iface }}">
                                    {{ "{:,}".format(stats.bytes_sent) }} Bytes
                                </div>
                            </div>
                            <div class="network-stat">
                                <div>Received</div>
                                <div class="network-stat-value" id="bytes-recv-{{ iface }}">
                                    {{ "{:,}".format(stats.bytes_recv) }} Bytes
                                </div>
                            </div>
                            <div class="network-stat">
                                <div>Packets Sent</div>
                                <div class="network-stat-value" id="packets-sent-{{ iface }}">
                                    {{ "{:,}".format(stats.packets_sent) }}
                                </div>
                            </div>
                            <div class="network-stat">
                                <div>Packets Received</div>
                                <div class="network-stat-value" id="packets-recv-{{ iface }}">
                                    {{ "{:,}".format(stats.packets_recv) }}
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            
            <div class="card">
                <div class="card-header uptime">
                    <span>‚ö° Voltages</span>
                </div>
                <div class="stat-value">
                    <a href="#" id="toggle-details" class="toggle-button">Show Voltage Details</a>
                </div>
                <div class="stat-small" id="details-content" style="display: none;">
                    <div>Throttled: <span id="throttled">{{ system_info.throttled or 'N/A' }}</span></div>
                    <div>Voltage (core): <span id="voltage-core">{{ system_info.voltages.core if system_info.voltages and system_info.voltages.core else 'N/A' }}</span> V</div>
                    <div>Voltage (SDRAM_C): <span id="voltage-sdram-c">{{ system_info.voltages.sdram_c if system_info.voltages and system_info.voltages.sdram_c else 'N/A' }}</span> V</div>
                    <div>Voltage (SDRAM_I): <span id="voltage-sdram-i">{{ system_info.voltages.sdram_i if system_info.voltages and system_info.voltages.sdram_i else 'N/A' }}</span> V</div>
                    <div>Voltage (SDRAM_P): <span id="voltage-sdram-p">{{ system_info.voltages.sdram_p if system_info.voltages and system_info.voltages.sdram_p else 'N/A' }}</span> V</div>
                </div>
                <div class="chart-container small-charts">
                    <canvas id="volt-throttle-chart" style="height:160px"></canvas>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Real-time monitoring | Historical data stored in database</p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='main.js') }}"></script>
</body>
</html>